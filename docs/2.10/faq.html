

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Spyne FAQ &mdash; spyne 2.10.8 documentation</title>
    
    <link rel="stylesheet" href="static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.10.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="spyne 2.10.8 documentation" href="index.html" />
    <link rel="next" title="History and Future" href="h_and_f.html" />
    <link rel="prev" title="Running Tests" href="tests.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="h_and_f.html" title="History and Future"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tests.html" title="Running Tests"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">spyne 2.10.8 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Spyne FAQ</a><ul>
<li><a class="reference internal" href="#does-spyne-support-the-soap-1-2-standard">Does spyne support the SOAP 1.2 standard?</a></li>
<li><a class="reference internal" href="#how-do-i-implement-a-predefined-wsdl">How do I implement a predefined WSDL?</a></li>
<li><a class="reference internal" href="#how-do-i-use-variable-names-that-are-also-python-keywords">How do I use variable names that are also Python keywords?</a></li>
<li><a class="reference internal" href="#how-does-spyne-behave-in-a-multi-threaded-environment">How does Spyne behave in a multi-threaded environment?</a></li>
<li><a class="reference internal" href="#what-implications-does-spyne-s-license-lgpl-have-for-proprietary-projects-that-use-it">What implications does Spyne&#8217;s license (LGPL) have for proprietary projects that use it?</a></li>
<li><a class="reference internal" href="#my-app-freezes-under-mod-wsgi-help">My app freezes under mod_wsgi! Help!</a></li>
<li><a class="reference internal" href="#you-mock-my-pain">You mock my pain!</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tests.html"
                        title="previous chapter">Running Tests</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="h_and_f.html"
                        title="next chapter">History and Future</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="sources/faq.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="spyne-faq">
<h1>Spyne FAQ<a class="headerlink" href="#spyne-faq" title="Permalink to this headline">¶</a></h1>
<p>Frequently asked questions about Spyne and related libraries.</p>
<div class="section" id="does-spyne-support-the-soap-1-2-standard">
<h2>Does spyne support the SOAP 1.2 standard?<a class="headerlink" href="#does-spyne-support-the-soap-1-2-standard" title="Permalink to this headline">¶</a></h2>
<p><strong>Short answer:</strong> No.</p>
<p><strong>Long answer:</strong> Nope.</p>
<p>Patches are welcome.</p>
</div>
<div class="section" id="how-do-i-implement-a-predefined-wsdl">
<h2>How do I implement a predefined WSDL?<a class="headerlink" href="#how-do-i-implement-a-predefined-wsdl" title="Permalink to this headline">¶</a></h2>
<p><strong>Short answer:</strong> By hand.</p>
<p><strong>Long answer:</strong> Spyne does not have any functionality to parse an existing
WSDL document, nor a way of producing the necessary Python classes and method
stubs from an existing interface definition.</p>
<p>Patches are welcome for both of these points. Maybe you can start by adapting
the WSDL parser from <a class="reference external" href="http://rsl.sf.net">RSL</a>.</p>
</div>
<div class="section" id="how-do-i-use-variable-names-that-are-also-python-keywords">
<h2>How do I use variable names that are also Python keywords?<a class="headerlink" href="#how-do-i-use-variable-names-that-are-also-python-keywords" title="Permalink to this headline">¶</a></h2>
<p>Due to restrictions of the python language, you can&#8217;t do this:</p>
<div class="highlight-python"><pre>class SomeClass(ComplexModel):
    and = String
    or = Integer
    import = Datetime</pre>
</div>
<p>The workaround is as follows:</p>
<div class="highlight-python"><pre>class SomeClass(ComplexModel):
    _type_info = {
        'and': String
        'or': Integer
        'import': Datetime
    }</pre>
</div>
<p>You also can&#8217;t do this:</p>
<div class="highlight-python"><pre>@rpc(String, String, String, _returns=String)
def f(ctx, from, import):
    return '1234'</pre>
</div>
<p>The workaround is as follows:</p>
<div class="highlight-python"><pre>@rpc(String, String, String, _returns=String,
    _in_variable_names={'from_': 'from', 'import_': 'import'},
    _out_variable_name="return"
def f(ctx, from_, import_):
    return '1234'</pre>
</div>
<p>See here: <a class="reference external" href="https://github.com/arskom/spyne/blob/rpclib-2.5.0-beta/src/rpclib/test/test_service.py#L114">https://github.com/arskom/spyne/blob/rpclib-2.5.0-beta/src/rpclib/test/test_service.py#L114</a></p>
</div>
<div class="section" id="how-does-spyne-behave-in-a-multi-threaded-environment">
<h2>How does Spyne behave in a multi-threaded environment?<a class="headerlink" href="#how-does-spyne-behave-in-a-multi-threaded-environment" title="Permalink to this headline">¶</a></h2>
<p>Spyne code is mostly re-entrant, thus thread safe. Whatever global state that is
accessed is initialized and frozen (by convention) before any rpc processing is
performed.</p>
<p>Some data (like the WSDL document) is initialized on first request,
which does need precautions against race conditions. These precautions should be
taken in the transport implementations. It&#8217;s the transport&#8217;s job to assure
thread-safety when accessing any out-of-thread data. No other parts of Spyne
should be made aware of threads.</p>
</div>
<div class="section" id="what-implications-does-spyne-s-license-lgpl-have-for-proprietary-projects-that-use-it">
<h2>What implications does Spyne&#8217;s license (LGPL) have for proprietary projects that use it?<a class="headerlink" href="#what-implications-does-spyne-s-license-lgpl-have-for-proprietary-projects-that-use-it" title="Permalink to this headline">¶</a></h2>
<p>DISCLAIMER: This is not legal advice, but just how we think things should work.</p>
<p><strong>Short Answer:</strong> As long as you don&#8217;t modify Spyne itself, you can freely use
Spyne in conjunction with your proprietary code, without any additional
obligations.</p>
<p><strong>Long Answer:</strong> If you make modifications to Spyne, the best thing to do is to
put them on github and just send a pull request upstream. Even if your patch
is not accepted, you&#8217;ve done more than what the license requires you to do.</p>
<p>If you make modifications to Spyne and deploy a modified version to your
client&#8217;s site, the minimum you should do is to pass along the source code for
the modified Spyne to your clients. Again, you can just put your modifications
up somewhere, or better, send them to the Spyne maintainers, but if for some
reason (we can&#8217;t imagine any, to be honest) you can&#8217;t do this, your obligation
is to have your client have the source code with your modifications.</p>
<p>The thing to watch out for when distributing a modified Spyne version as
part of your proprieatry solution is to make sure that Spyne runs just fine by
itself without needing your code. Again, this will be the case if you did not
touch Spyne code itself.</p>
<p>If your modifications to Spyne make it somehow dependant on your software, you
must pass your modifications as well as the code that Spyne needs to the
people who deploy your solution. In other words, if your code and Spyne is
tightly coupled, the license of Spyne propagates to your code as well.</p>
<p>Spyne is a descendant of Soaplib, which was published by its author initially
under LGPL. When he quit, the people who took over contemplated re-licensing it
under the three-clause BSD license, but were not able to reach the original
author. A re-licensing is even less probable today because of the number of
people who&#8217;ve contributed code in the past years as we&#8217;d need to get the
approval of every single person in order to re-license Spyne.</p>
<p>It&#8217;s also not possible to distribute Spyne under a dual license model for the
same reason &#8211; everybody would have to approve the new licensing terms.</p>
</div>
<div class="section" id="my-app-freezes-under-mod-wsgi-help">
<h2>My app freezes under mod_wsgi! Help!<a class="headerlink" href="#my-app-freezes-under-mod-wsgi-help" title="Permalink to this headline">¶</a></h2>
<p><strong>Short answer:</strong> Add this to the relevant fragment of your Apache
configuration:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">WSGIApplicationGroup</span> <span class="o">%</span><span class="p">{</span><span class="n">GLOBAL</span><span class="p">}</span>
</pre></div>
</div>
<p><strong>Long answer:</strong> See here: <a class="reference external" href="https://techknowhow.library.emory.edu/blogs/branker/2010/07/30/django-lxml-wsgi-and-python-sub-interpreter-magic">https://techknowhow.library.emory.edu/blogs/branker/2010/07/30/django-lxml-wsgi-and-python-sub-interpreter-magic</a></p>
<p>Copying the blog post here in case the original link disappears:</p>
<blockquote>
<div><p><strong>[Django] lxml, WSGI, and Python sub-interpreter magic</strong></p>
<blockquote>
<div><em>Posted Fri, 07/30/2010 - 18:21 by branker</em></div></blockquote>
<p>One of the applications we’ve been spending a fair chunk of time on here in
the library is a user-friendly front-end to our fedora repository. It’s
built on internally-developed Python libraries for repository access, XML
data mapping, and Django tie-ins. We’re aiming to opensource that library
soon, but this post isn’t about that library. In fact, it’s only sort of
about the application. This post is about an interesting problem we ran
into this week when trying to deploy that application into our staging
environment for testing.</p>
<p>See, we’ve made some great strides with development, and we’re ready to put
them up so that our users—mostly our own librarians for now—can test them.
Development has progressed smoothly under Django’s manage.py runserver. The
other day, though, when we ran our application under apache, it surprised
us by locking up hard.</p>
<p>Now, I can’t think of the last time I saw an http daemon freeze up like
that, but it was clear that’s what was happening. The web request wasn’t
returning anything (not even a 500 Internal Server Error). Browsers just
sat there spinning. curl sat waiting for a response. And eventually apache
would give up and drop the connection. It was dead at the starting bell,
and with no prior warning of any problems in development. We were
confounded.</p>
<p>Debugging was an interesting experience, and I hope to post sometime about
how that progressed. In the end, though, we figured out it was a design
decision that made it happen. Here are the players in this drama:</p>
<p>lxml is a fine XML processing library for Python. We use it to process XML
as we communicate with fedora. We particularly picked it because it
supports XPath expressions, XSLT, and XML Schema, and because it’s pretty
darn portable with minimal fuss.</p>
<p>Cython is a tool for gluing together C and Python. I started using a
variant called Pyrex several years ago, and I happen to think the approach
is a great one. lxml happens to use Cython internally. Most users will
never need to know that fact, but it becomes relevant in a bit.</p>
<p>Django is our web development framework of choice these days at Emory
Libraries. It’s written in Python, which has given us a huge dose of
flexibility, stability, and power in our development.</p>
<p>mod_wsgi is how we deploy our Django code to production. There are other
options, but we’ve found WSGI gives us the best mix of flexibility and
stability so far.</p>
<p>Unfortunately, it was a combination of design decisions in those tools—
particularly Cython, Python, and WSGI—that locked up our app.</p>
<p>The problem, it turns out, is subtle, but it stems from the use of Cython
(via lxml) and mod_wsgi together. These can be made to work together, but
it requires careful configuration to work around some incompatibilities.
This is complicated by some further design decisions in Django, which I’ll
say more about in a bit. First, lxml, Cython, and the simplified GIL
interface.</p>
<p>Cython, as mentioned above, is a tool for gluing together C and Python. The
idea is you write code that looks a lot like Python, but with a few C-like
warts, and Cython compiles your code down to raw C. This is perfect for
exposing C libraries in Pythonic idioms, and lxml uses it to great effect
to provide its XML access. Now, Cython happens to use Python’s simplified
GIL interface internally for locking. Unfortunately this means that it’s
incompatible with an obscure Python feature called sub-interpreters. Most
applications don’t need to use this feature. Most applications—notably
including Django’s manage.py runserver—never notice or care.</p>
<p>mod_wsgi is a perfect example of good use of sub-interpreters. It uses them
to allow apache admins to run lots of little WSGI-based web apps all in a
single process, but still give each one its own Python environment. Without
this, things like Django’s model registration patterns—along with similar
global systems in many other Python libraries—would leave separate
applications all interfering with each other.</p>
<p>Unfortunately, given that Cython-based libraries are incompatible with sub-
interpreters, and given that mod_wsgi uses sub-interpreters, it follows
logically that Cython-based libraries like lxml are incompatible with
simple mod_wsgi configurations. In our case, this manifested as a single-
thread self-deadlock in the Python Global Interpreter Lock whenever we
tried to use our application at all. We were lucky: As the Python C-API
docs say, “Simple things may work, but confusing behavior will always be
near.”</p>
<p>Now, once that incompatibility is recognized and accepted, hope is not
lost. If you’re only running a single WSGI application, your workaround
might even be easy. You can force a mod_wsgi application to avoid the
problem by forcing it into the global application group:</p>
<p>WSGIApplicationGroup %{GLOBAL}</p>
<p>If you want to run multiple WSGI applications, though, they might not play
so well all together like that. Remember, as I described above, WSGI uses
sub-interpreters to prevent applications from accidentally stepping on each
other. Django applications, in particular, must run in separate sub-
interpreters. If you want to run a couple of them, and they’re all
incompatible with sub-interpreters, you need to keep them separate.</p>
<p>We’re just starting to deal with this problem, but it looks like mod_wsgi
daemon processes are just what the doctor ordered. What we’re looking at
right now is using a separate WSGIDaemonProcess for each lxml-enabled
Django site. According to the docs, this should eliminate sub-interpreter
conflicts while still giving each application its own distinct interpreter
space. Which will probably eat some system resources, but it’s better than
locking up on every request.</p>
<p>I’ll update this post if the strategy turns out not to work. So far,
though, I’m hopeful.</p>
</div></blockquote>
</div>
<div class="section" id="you-mock-my-pain">
<h2>You mock my pain!<a class="headerlink" href="#you-mock-my-pain" title="Permalink to this headline">¶</a></h2>
<p>Life is pain, highness. Anyone who says differently is selling something.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="h_and_f.html" title="History and Future"
             >next</a> |</li>
        <li class="right" >
          <a href="tests.html" title="Running Tests"
             >previous</a> |</li>
        <li><a href="index.html">spyne 2.10.8 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright Spyne Contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>